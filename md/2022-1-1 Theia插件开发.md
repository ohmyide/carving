---
title: Theia插件开发
date: 2022-1-1
tags: Theia
---

# Theia开发入门：插件

Theia：An Open, Flexible and Extensible Cloud & Desktop IDE Platform，一个开放、灵活、可扩展的远端（web）和本地（electron）IDE 平台；

## Theia的市场定位



## Theia插件和VS Code插件的关系

Theia为开发者提供的功能开发途径有两个：

- 插件
- 拓展

VS Code对外提供的开发途径只有一种：

- 插件

在VS Code文档中称为：[Extension](https://code.visualstudio.com/api)

## Theia插件和Theia拓展的关系

Theia插件等同于VS Code插件，是利用 IDE 在各个模块对外开放的 API 来实现自定义功能，这意味着：用户所能开发的范围天然受制于暴露的 API 数量，VS Code 插件市场虽然异常繁荣，但无法改变 IDE 主体框架，均属于“夹缝中的一小片自由地”；

对于自定义程度较高的业务场景，如：小程序 IDE，插件显然无法满足需求，因此Theia提供了拓展机制，开发者可以基于拓展，灵活的制定自己想要的 IDE，如：Mbed Studio

<img src="/Users/wangjin/Library/Application Support/typora-user-images/image-20211030023324632.png" alt="image-20211030023324632" style="zoom:50%;" />



## 开发Theia插件：先了解VS Code插件

通过VS Code插件形成全局知识，VS Code文档相对比较全，插件案例很多，插件开发经验能无缝迁移到Theia的插件开发中，且Theia插件能兼容 VS Code 插件，其原理在于Theia源码中 plugin-vscode-init.ts 文件：

```javascript
// vscodeModuleName: vscode
module._load = function (request: string, parent: any, isMain: {}): any {
    if (request !== vscodeModuleName) {
        return internalLoad.apply(this, arguments);
    }

    const plugin = findPlugin(parent.filename);
    if (plugin) {
        const apiImpl = pluginsApiImpl.get(plugin.model.id);
        return apiImpl;
    }

    if (!defaultApi) {
        console.warn(`Could not identify plugin for 'Theia' require call from ${parent.filename}`);
        defaultApi = pluginApiFactory(emptyPlugin);
    }

    return defaultApi;
};
```

当Theia插件中的代码加载vscode模块时，被拦截到内部新建的vscode对象中；

通过vs插件，能够获得以下能力地图：

- 理解插件的能力范围
- 哪些功能大致可以用插件的哪些能力实现

